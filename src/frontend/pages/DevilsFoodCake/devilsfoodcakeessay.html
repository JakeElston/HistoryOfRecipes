<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devil's Food Cake Essay</title>
    <!-- Use inline CSS for iframe content -->
    <style>
        :root {
            --primary-brown: #6b4e3d;
            --text-color: #333;
        }
        body {
            font-family: "Inter", sans-serif;
            color: var(--text-color);
            line-height: 1.75;
            padding: 2rem;
        }
        .essay-text {
            margin: 0; 
        }
        .essay-text p {
            margin-bottom: 1rem;
            text-indent: 1.5rem; /* Standard essay paragraph indent */
            text-align: justify;
        }
        h4 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-brown);
        }
    </style>
</head>
<body>
    <div id="essay-content" class="essay-text">
        <p>Loading essay...</p>
    </div>

    <script>
        // Hardcoded ID for Devil's Food Cake
        const essayId = '68e3f67c6eb7b550d54f7d4e';
        const API_BASE_URL = 'http://localhost:5000';
        const contentContainer = document.getElementById('essay-content');

        function renderEssayContent(essayText) {
            // Split by double newline to detect paragraphs/sections
            const sections = essayText.split(/\n\n+/).filter(s => s.trim() !== '');
            let html = '';

            sections.forEach(section => {
                const lines = section.split('\n').map(line => line.trim()).filter(line => line !== '');
                
                if (lines.length === 0) return;

                // Treat all content as a single essay paragraph block per section
                html += `<p>${lines.join(' ')}</p>`;
            });
            
            contentContainer.innerHTML = html;
        }

        // Fetch the specific essay by ID
        fetch(`${API_BASE_URL}/essays/${essayId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Essay not found. Check ID and server path.');
                }
                return response.json();
            })
            .then(data => {
                // Render the essay content
                renderEssayContent(data.essay || '');
            })
            .catch(error => {
                console.error('Error fetching essay:', error);
                contentContainer.innerHTML = '<p class="text-red-600">Error loading essay. Please check your network and server logs.</p>';
            });
    </script>
</body>
</html>